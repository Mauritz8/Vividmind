#pragma once

#include "board/board.hpp"
#include <array>

const int KING_VALUE = 100000;
const int QUEEN_VALUE = 900;
const int ROOK_VALUE = 500;

// TODO: reconsider what the bishop's value should be
const int BISHOP_VALUE = 350;

const int KNIGHT_VALUE = 300;
const int PAWN_VALUE = 100;

const std::array<int, NR_PIECES> PIECE_VALUES = { PAWN_VALUE, KNIGHT_VALUE,
    BISHOP_VALUE, ROOK_VALUE, QUEEN_VALUE, KING_VALUE };

const std::array<int, 64> KING_PSQT = {
    -30, -40, -40, -50, -50, -40, -40, -30,
    -30, -40, -40, -50, -50, -40, -40, -30,
    -30, -40, -40, -50, -50, -40, -40, -30,
    -30, -40, -40, -50, -50, -40, -40, -30,
    -20, -30, -30, -40, -40, -30, -30, -20,
    -10, -20, -20, -20, -20, -20, -20, -10,
     20,  20,   0, -10, -10,   0,  20,  20,
     20,  30,  10, -10,   0,  10,  30,  20,
};

const std::array<int, 64> KING_ENDGAME_PSQT = {
    -50, -40, -30, -20, -20, -30, -40, -50,
    -30, -20, -10,   0,   0, -10, -20, -30,
    -30, -10,  20,  30,  30,  20, -10, -30,
    -30, -10,  30,  40,  40,  30, -10, -30,
    -30, -10,  30,  40,  40,  30, -10, -30,
    -30, -10,  20,  30,  30,  20, -10, -30,
    -30, -30,   0,   0,   0,   0, -30, -30,
    -50, -30, -30, -30, -30, -30, -30, -50
};

const std::array<int, 64> BISHOP_PSQT = {
    -20, -10, -10, -10, -10, -10, -10, -20,
    -10,   0,   0,   0,   0,   0,   0, -10,
    -10,   0,   5,  10,  10,   5,   0, -10,
    -10,   5,   5,  10,  10,   5,   5, -10,
    -10,   0,  10,  10,  10,  10,   0, -10,
    -10,  10,  10,  10,  10,  10,  10, -10,
    -10,   5,   0,   0,   0,   0,   5, -10,
    -20, -10, -10, -10, -10, -10, -10, -20,
};

const std::array<int, 64> KNIGHT_PSQT = {
    -50, -40, -30, -30, -30, -30, -40, -50,
    -40, -20,   0,   0,   0,   0, -20, -40,
    -30,   0,  10,  15,  15,  10,   0, -30,
    -30,   5,  15,  20,  20,  15,   5, -30,
    -30,   0,  15,  20,  20,  15,   0, -30,
    -30,   5,  10,  15,  15,  10,   5, -30,
    -40, -20,   0,   5,   5,   0, -20, -40,
    -50, -40, -30, -30, -30, -30, -40, -50,
};

const std::array<int, 64> PAWN_PSQT = {
     0,   0,   0,   0,   0,   0,   0,   0,
    50,  50,  50,  50,  50,  50,  50,  50,
    10,  10,  20,  30,  30,  20,  10,  10,
     5,   5,  10,  25,  25,  10,   5,   5,
     0,   0,   0,  20,  20,   0,   0,   0,
     5,  -5, -10,   0,   0, -10,  -5,   5,
     5,  10,  10, -20, -20,  10,  10,   5,
     0,   0,   0,   0,   0,   0,   0,   0,
};

const std::array<int, 64> QUEEN_PSQT = {
    -20, -10, -10, -5, -5, -10, -10, -20,
    -10,   0,   0,  0,  0,   0,   0, -10,
    -10,   0,   5,  5,  5,   5,   0, -10,
     -5,   0,   5,  5,  5,   5,   0,  -5,
      0,   0,   5,  5,  5,   5,   0,  -5,
    -10,   5,   5,  5,  5,   5,   0, -10,
    -10,   0,   5,  0,  0,   0,   0, -10,
    -20, -10, -10, -5, -5, -10, -10, -20,
};

const std::array<int, 64> ROOK_PSQT = {
    0,   0,   0,   0,   0,   0,   0,   0, 
    5,  10,  10,  10,  10,  10,  10,   5,
   -5,   0,   0,   0,   0,   0,   0,  -5,
   -5,   0,   0,   0,   0,   0,   0,  -5,
   -5,   0,   0,   0,   0,   0,   0,  -5,
   -5,   0,   0,   0,   0,   0,   0,  -5,
   -5,   0,   0,   0,   0,   0,   0,  -5,
    0,   0,   0,   5,   5,   0,   0,   0,
};

// when the king is the only piece left, force it to the edge of the board 
// if no checkmate is found
const std::array<int, 64> KING_MATE = {
    -50, -50, -50, -50, -50, -50, -50, -50,
    -50, -30, -30, -30, -30, -30, -30, -50,
    -50, -30,  30,  30,  30,  30, -30, -50,
    -50, -30,  30,  50,  50,  30, -30, -50,
    -50, -30,  30,  50,  50,  30, -30, -50,
    -50, -30,  30,  30,  30,  30, -30, -50,
    -50, -30, -30, -30, -30, -30, -30, -50,
    -50, -50, -50, -50, -50, -50, -50, -50,
};

int evaluate(const Board &board);
int get_psqt_score(PieceType piece_type, int pos, Color color,
                   bool is_lone_king, bool is_endgame);

const std::array<std::array<int, 64>, NR_PIECES> PSQTs = { PAWN_PSQT,
    KNIGHT_PSQT, BISHOP_PSQT, ROOK_PSQT, QUEEN_PSQT, KING_PSQT };

const std::array<int, 64> FLIPPED_BOARD = {
    56, 57, 58, 59, 60, 61, 62, 63, 
    48, 49, 50, 51, 52, 53, 54, 55, 
    40, 41, 42, 43, 44, 45, 46, 47, 
    32, 33, 34, 35, 36, 37, 38, 39, 
    24, 25, 26, 27, 28, 29, 30, 31, 
    16, 17, 18, 19, 20, 21, 22, 23, 
    8,  9,  10, 11, 12, 13, 14, 15, 
    0,  1,  2,  3,  4,  5,  6,  7
};
